@if(videoTitle) {
  <h2 class="video-title">{{videoTitle}}</h2>
}
<div #videoContainer class="video-container" [ngClass]="{'paused': videoElement?.paused}" data-volume-level="high">
  <img class="thumbnail-img" [src]="thumbnailImgSrc">
  <div class="video-controls-container">
    <div #timelineContainer class="timeline-container" (mousemove)="handleTimelineUpdate($event)"
      (mousedown)="toggleScrubbing($event)">
      <div class="timeline">
        <img class="preview-img" [src]="previewImgSrc">
        <div class="thumb-indicator"></div>
      </div>
    </div>
    <div class="controls">
      <!-- Botón de reproducir y pausar -->
      <button class="play-pause-btn" (click)="togglePlay()">
        <svg class="play-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M8,5.14V19.14L19,12.14L8,5.14Z" />
        </svg>
        <svg class="pause-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M14,19H18V5H14M6,19H10V5H6V19Z" />
        </svg>
      </button>
      <!-- Controlador de volumen -->
      <div class="volume-container">
        <button class="mute-btn" (click)="toggleMute()">
          <svg class="volume-high-icon" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z" />
          </svg>
          <svg class="volume-low-icon" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M5,9V15H9L14,20V4L9,9M18.5,12C18.5,10.23 17.5,8.71 16,7.97V16C17.5,15.29 18.5,13.76 18.5,12Z" />
          </svg>
          <svg class="volume-muted-icon" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M12,4L9.91,6.09L12,8.18M4.27,3L3,4.27L7.73,9H3V15H7L12,20V13.27L16.25,17.53C15.58,18.04 14.83,18.46 14,18.7V20.77C15.38,20.45 16.63,19.82 17.68,18.96L19.73,21L21,19.73L12,10.73M19,12C19,12.94 18.8,13.82 18.46,14.64L19.97,16.15C20.62,14.91 21,13.5 21,12C21,7.72 18,4.14 14,3.23V5.29C16.89,6.15 19,8.83 19,12M16.5,12C16.5,10.23 15.5,8.71 14,7.97V10.18L16.45,12.63C16.5,12.43 16.5,12.21 16.5,12Z" />
          </svg>
        </button>
        <input #volumeSlider class="volume-slider" type="range" min="0" max="1" step="any" value="1"
          (input)="onVolumeInput($event)">
      </div>
      <!-- Contenedor de duración del video -->
      <div class="duration-container">
        <div class="current-time">{{currentTime}}</div>
        /
        <div class="total-time">{{totalTime}}</div>
      </div>
      <!-- Botón de subtítulos -->
      <button class="captions-btn" (click)="$event.stopPropagation();toggleSubtitlesMenu()">
        <svg viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M18,11H16.5V10.5H14.5V13.5H16.5V13H18V14A1,1 0 0,1 17,15H14A1,1 0 0,1 13,14V10A1,1 0 0,1 14,9H17A1,1 0 0,1 18,10M11,11H9.5V10.5H7.5V13.5H9.5V13H11V14A1,1 0 0,1 10,15H7A1,1 0 0,1 6,14V10A1,1 0 0,1 7,9H10A1,1 0 0,1 11,10M19,4H5C3.89,4 3,4.89 3,6V18A2,2 0 0,0 5,20H19A2,2 0 0,0 21,18V6C21,4.89 20.1,4 19,4Z" />
        </svg>
      </button>
      <!-- Botón de Opciones de calidad -->
      <button class="quality-btn" (click)="$event.stopPropagation();toggleQualityMenu()">
        <svg viewBox="0 4 28 36">
          <use class="ytp-svg-shadow" xlink:href="#ytp-id-19"></use>
          <path
            d="m 23.94,18.78 c .03,-0.25 .05,-0.51 .05,-0.78 0,-0.27 -0.02,-0.52 -0.05,-0.78 l 1.68,-1.32 c .15,-0.12 .19,-0.33 .09,-0.51 l -1.6,-2.76 c -0.09,-0.17 -0.31,-0.24 -0.48,-0.17 l -1.99,.8 c -0.41,-0.32 -0.86,-0.58 -1.35,-0.78 l -0.30,-2.12 c -0.02,-0.19 -0.19,-0.33 -0.39,-0.33 l -3.2,0 c -0.2,0 -0.36,.14 -0.39,.33 l -0.30,2.12 c -0.48,.2 -0.93,.47 -1.35,.78 l -1.99,-0.8 c -0.18,-0.07 -0.39,0 -0.48,.17 l -1.6,2.76 c -0.10,.17 -0.05,.39 .09,.51 l 1.68,1.32 c -0.03,.25 -0.05,.52 -0.05,.78 0,.26 .02,.52 .05,.78 l -1.68,1.32 c -0.15,.12 -0.19,.33 -0.09,.51 l 1.6,2.76 c .09,.17 .31,.24 .48,.17 l 1.99,-0.8 c .41,.32 .86,.58 1.35,.78 l .30,2.12 c .02,.19 .19,.33 .39,.33 l 3.2,0 c .2,0 .36,-0.14 .39,-0.33 l .30,-2.12 c .48,-0.2 .93,-0.47 1.35,-0.78 l 1.99,.8 c .18,.07 .39,0 .48,-0.17 l 1.6,-2.76 c .09,-0.17 .05,-0.39 -0.09,-0.51 l -1.68,-1.32 0,0 z m -5.94,2.01 c -1.54,0 -2.8,-1.25 -2.8,-2.8 0,-1.54 1.25,-2.8 2.8,-2.8 1.54,0 2.8,1.25 2.8,2.8 0,1.54 -1.25,2.8 -2.8,2.8 l 0,0 z"
            fill="#fff" id="ytp-id-19"></path>
        </svg>
      </button>
      <!-- Botón de velocidad -->
      <button class="speed-btn wide-btn" (click)="changePlaybackSpeed()">
        {{playbackRate}}
      </button>
      <!-- Botón de mini reproductor -->
      <button class="mini-player-btn" (click)="toggleMiniPlayerMode()">
        <svg viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14zm-10-7h9v6h-9z" />
        </svg>
      </button>
      <!-- Botón de modo teatro -->
      <button class="theater-btn" (click)="toggleTheaterMode()">
        <svg class="tall" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 10H5V8h14v8z" />
        </svg>
        <svg class="wide" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 8H5V9h14v6z" />
        </svg>
      </button>
      <!-- Botón de pantalla completa -->
      <button class="full-screen-btn" (click)="toggleFullScreenMode()">
        <svg class="open" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" />
        </svg>
        <svg class="close" viewBox="0 0 24 24">
          <path fill="currentColor" d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z" />
        </svg>
      </button>
    </div>
  </div>
  <!-- Video -->
  <video #videoElement [src]="selectedSource.src" (click)="togglePlay()" (volumechange)="onVolumeChange()"
    (loadeddata)="onLoadedData()" (timeupdate)="onTimeUpdate()">
    @if (subtitleSources.length > 0) {
    @for(subtitle of subtitleSources; track subtitle.srclang) {
    <track kind="subtitles" [src]="subtitle.src" [srclang]="subtitle.srclang" [label]="subtitle.label"
      [default]="subtitle.default">
    }
    }
  </video>
  <!-- Menú de opciones de calidad -->
  <app-settings-menu title="Seleccionar Calidad" [options]="videoSources" [menuOpen]="qualityMenuOpen"
    [selectedOption]="selectedSource" (optionSelected)="changeQuality($event)"
    (menuClosed)="toggleQualityMenu()"></app-settings-menu>
  <!-- Menú de opciones de subtítulos -->
  <app-settings-menu title="Seleccionar Subtítulos" [options]="subtitleSources" [menuOpen]="subtitleMenuOpen"
    [selectedOption]="selectedSubtitle" [cancelButton]="showDisableSubButton" cancelButtonLabel="Desactivar"
    (optionSelected)="changeSubtitle($event)" (menuClosed)="toggleSubtitlesMenu()"
    (optionCancelled)="disableSubtitles()"></app-settings-menu>
</div>
